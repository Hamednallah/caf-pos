package com.yourcompany.cafeteria.ui; import javafx.fxml.FXML; import javafx.scene.control.*; import com.yourcompany.cafeteria.util.DataSourceProvider; import com.yourcompany.cafeteria.service.SettingsService; import com.yourcompany.cafeteria.util.ReceiptPrinter; import com.yourcompany.cafeteria.service.PrinterService; public class SettingsController { @FXML private ComboBox<String> printerCombo; @FXML private Label status; @FXML public void initialize(){ printerCombo.getItems().addAll(com.yourcompany.cafeteria.util.ReceiptPrinter.listPrinters()); try (var c = DataSourceProvider.getConnection()){ var svc = new SettingsService(c); var def = svc.get("printer.default"); if(def!=null) printerCombo.setValue(def); } catch(Exception e){ e.printStackTrace(); } } @FXML public void handleSavePrinter(){ try (var c = DataSourceProvider.getConnection()){ new SettingsService(c).set("printer.default", printerCombo.getValue()); status.setText("Saved: " + printerCombo.getValue()); } catch(Exception e){ e.printStackTrace(); } } @FXML public void handleTestPrint(){ try { ReceiptPrinter.print("TEST PRINT\nCafeteria POS\n"); status.setText("Sent test print"); } catch(Exception e){ e.printStackTrace(); status.setText("Print failed: " + e.getMessage()); } } }
